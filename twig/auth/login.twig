{{ '<script type="application/javascript" async src="{{ url }}/assets/js/simpleWebauthn/index.umd.min.js"></script>'|addJS(true) }}

{% include '/general/header_noNav.twig' %}
<div class=" justify-content-center">
  <div class="d-flex flex-column align-items-center w-lg-50 h-100 px-3 px-lg-5 pt-5">
    <div class="w-100 mt-auto" style="max-width: 526px;">
      {% include '/general/actionMessage.twig' %}
      <h1>{{ 'site.auth.login' | language }}</h1>
      <p class="pb-3 mb-3 mb-lg-4">{{ 'site.login.not_registered' | language }}&nbsp;&nbsp;<a
                href='{{ url }}/auth/register{{ return_to }}'>{{ 'site.login.create_account' | language }}</a>
      </p>

      <div id="qrCodeForm" style="display:none">
        <div class="row justify-content-center" id="qrCodeFormLoader">
          <div class="spinner-border" role="status">
            <span class="sr-only">Loading...</span>
          </div>
        </div>
        <div id="qrCode">
          <p class="text-muted mb-5">{{ 'site.auth.login.scanQRCode' | language }}
            <button type="button" id="qrLogin-btn-cancelFull" class="btn btn-sm btn-outline-danger">{{ 'site.auth.login.scanQRCode.cancelFull' | language }}</button></p>

          <div class="row justify-content-center" style="display: none" id="qrCodeFormUserInfo">
            <div class="d-flex align-items-center justify-content-center">
              <img id="qrCodeFormUserInfoIMG" width="72" height="62"  alt="" src="" class="avatar avatar-xl rounded-circle">
              <div class="ps-2">
                <div class="text-dark" id="qrCodeFormUserInfoName">Name</div>
                <div class="text-muted" id="qrCodeFormUserInfoRank">Rank</div>
              </div>
            </div>

            <div class="col-12 mt-4 text-center">
              <small>{{ 'site.auth.login.scanQRCode.notYou' | language }}</small>
              <a id="qrLogin-btn"
                 class="small font-weight-bold">{{ 'site.auth.login.scanQRCode.cancel' | language }}</a>
            </div>
          </div>
        </div>
      </div>
      <div id="loginForm">
        <div class="pb-3 mb-3">
          <div class="position-relative"><i class="fa fa-at fs-lg position-absolute top-50 start-0 translate-middle-y ms-3"></i>
            <input class="form-control form-control-lg ps-5" type="email" id="username" placeholder="{{ 'general.form.email.placeholder' | language }}" required="" autocomplete="username webauthn">
          </div>
        </div>
        <div class="mb-4">
          <div class="position-relative"><i class="fa fa-lock fs-lg position-absolute top-50 start-0 translate-middle-y ms-3"></i>
            <div class="password-toggle">
              <input class="form-control form-control-lg ps-5" type="password" id="password" placeholder="{{ 'general.form.password.placeholder' | language }}" required="" autocomplete="password webauthn">
            </div>
          </div>
        </div>
        <div class="d-flex flex-wrap align-items-center justify-content-between pb-4">
          <div id="recaptcha"></div>
        </div>
        <div class="d-flex flex-wrap align-items-center justify-content-between pb-4">
          <form-check class="my-1">
            <input class="form-check-input" type="checkbox" id="remember_login">
            <label class="form-check-label ms-1"
                   for="remember_login">{{ 'general.form.remember' | language }}</label>
          </form-check>
          <a class="fs-sm fw-semibold text-decoration-none my-1"
             href="{{ url }}/auth/forgotPW{{ return_to }}">{{ 'site.login.forgot_password' | language }}</a>
        </div>
        <div id="form">
          <button class="btn btn-lg btn-primary w-100 mb-4" type="button" onclick="onSiteLogin()">{{ 'site.login.form.sign_in' | language }}
          </button>
        </div>
        <div id="loader" style="display: none">
          <button type="button" class="btn btn-lg btn-primary w-100 mb-4 pe-none">
            <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
            {{ 'site.login.form.sign_in' | language }}...
          </button>
        </div>
        <h2 class="h6 text-center pt-3 pt-lg-4 mb-4">{{ 'site.login.form.or' | language }}</h2>
        <div class="row justify-content-center">
          {% if avAccounts|length != 0 %}
            {% for account in avAccounts %}
              <div class="col-3">

                <a href="{{ url }}/auth/r/{{ account['identifier'] }}{{ return_to }}"
                   class="btn btn-outline-secondary btn-icon mb-2 w-100">
                  {% if account['shortName'] == "TheSystems" %}
                    <img src="https://cdn.the-systems.eu/icon-transparent.png" alt="TheSystems"
                         height="10" width="30">
                  {% elseif account['shortName'] == "Discord" %}
                    <i class="fab fa-discord"></i>
                  {% elseif account['shortName'] == "Apple" %}
                    <i class="fab fa-apple"></i>
                  {% elseif account['shortName'] == "Google" %}
                    <i class="fab fa-google"></i>
                  {% endif %}
                </a>

              </div>
            {% endfor %}
          {% endif %}
        </div>
        <div class="row row-cols-1 row-cols-sm-2 gy-3">

          <div class="col" id="webauthn" style="display: none">
            <button type="button" onclick="startFido2Login();"
                    class="btn btn-icon btn-outline-secondary btn-lg w-100"><i
                      class="fa-solid fa-key-skeleton me-2"></i>{{ 'site.auth.login.fido2' | language }}
            </button>
          </div>
          <div class="col">
            <button type="button" id="createQRCode" style="display: none"
                    class="btn btn-icon btn-outline-secondary btn-lg w-100">
              <i class="fas fa-qrcode me-2"></i>
              {{ 'site.auth.login.scanQRCodeMethod' | language }}</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% include '/general/footer_empty.twig' %}